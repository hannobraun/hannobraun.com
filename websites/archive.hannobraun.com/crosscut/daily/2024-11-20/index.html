<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Daily Note - 2024-11-20 - Crosscut</title>
        <meta charSet="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="/crosscut/style.css" rel="stylesheet">
    </head>
    <body class="max-w-xl mx-auto p-2">
        <header><a href="/crosscut/"><h1>Crosscut</h1></a></header>
        <main>
            <h2>Daily Note - 2024-11-20</h2>
            <div class="m-4 p-4 rounded font-sm bg-slate-200">
                <p class="prose">
                    Hey, I'm Hanno! These are my daily notes on <a
                        href="https://github.com/hannobraun/crosscut"
                        class="text-blue-700 underline font-bold"
                    >Crosscut</a>, the programming language I'm creating. If you
                    have any questions, comments, or feedback, please <a
                        href="mailto:Hanno%20Braun%20%3Chello%40hannobraun.com%3E?subject=&body="
                        class="text-blue-700 underline font-bold"
                    >get in touch</a>!
                </p>
            </div>
            <div class="m-4 p-4 rounded font-sm bg-slate-200">
                <p>
                    This note was published <a
                        href="/crosscut/daily/2024-12-25"
                        class="text-blue-700 underline font-bold"
                    >
                        before Crosscut was called Crosscut</a>! If it refers to
                    "Caterpillar", that is the old name, just so you know.
                </p>
            </div>
            <div class="my-8">
                <nav>
                    <a
                        href="/crosscut/daily"
                        class="text-blue-700 underline font-bold"
                    >< back to list</a>
                </nav>
                <main class="prose">
                    <p>
                        The simple approach to expression-level rewind,
                        implementing it
                        <a
                            href="/crosscut/daily/2024-11-19"
                            rel="noopener noreferrer"
                        >in the runtime</a>, is pretty straight-forward: On
                        every bytecode instruction the runtime executes, it also
                        logs "undo instructions" into an "undo buffer". If
                        executed, those will undo the original instruction.
                        Rewinding just takes instructions out of that undo
                        buffer and executes them.
                    </p>
                    <p>
                        But what specifically are these undo instructions? They
                        could just be regular instructions. For example, let's
                        look at the expression <code>1 2 +</code>. Under the
                        hood, this would translate into the following
                        instructions:
                    </p>
                    <ol>
                        <li><code>push 1</code></li>
                        <li><code>push 2</code></li>
                        <li><code>add</code></li>
                    </ol>
                    <p>
                        To undo a "push" instruction, we'd just need to remove
                        the value that was pushed. So after executing
                        instructions 1 and 2, the undo buffer would contain
                        "<code>pop</code>, <code>pop</code>". This is an easy
                        case, because <em>every</em> <code>push x</code>
                        instruction would be undone by <code>pop</code>,
                        regardless of what <code>x</code> is.
                    </p>
                    <p>
                        The <code>add</code> is a bit more complicated. We need
                        to know about its inputs and outputs to undo it. But
                        since we're talking about doing this at runtime, we have
                        all that information. We can undo the <code>add</code>
                        with something like <code>pop</code> (to remove the
                        output), <code>push 1</code>, <code>push 2</code> (to
                        reconstruct the inputs).
                    </p>
                </main>
                <nav class="grid grid-cols-2">
                    <span class="col-1 justify-self-start"><a
                            href="/crosscut/daily/2024-11-19"
                            class="text-blue-700 underline font-bold"
                        ><< previous note</a></span><span
                        class="col-2 justify-self-end"
                    ><a
                            href="/crosscut/daily/2024-11-21"
                            class="text-blue-700 underline font-bold"
                        >next note >></a></span>
                </nav>
            </div>
        </main>
        <hr class="w-1/2 mx-auto my-16">
        <footer class="max-w-fit mx-auto text-sm">
            <p class="max-w-fit mx-auto italic">A website by</p>
            <address>
                <div>
                    Hanno Braun<br>Untere Pfarrgasse 19<br>64720
                    Michelstadt<br>Germany<br>
                </div>
                <div class="my-4">
                    ðŸ“§ <a href="mailto:hello@hannobraun.com"
                    >hello@hannobraun.com</a>
                </div>
            </address>
        </footer>
    </body>
</html>
